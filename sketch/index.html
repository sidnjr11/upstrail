<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Supply Chain Canvas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Top Menu Bar -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">Supply Chain Canvas</h1>
                <div class="header-actions">
                    <button class="btn btn--outline btn--sm" id="undoBtn" disabled>Undo (Ctrl+Z)</button>
                    <button class="btn btn--outline btn--sm" id="saveBtn">Save</button>
                    <button class="btn btn--outline btn--sm" id="loadBtn">Load</button>
                    <button class="btn btn--outline btn--sm" id="exportBtn">Export PNG</button>
                    <button class="btn btn--secondary btn--sm" id="clearBtn">Clear All</button>
                </div>
            </div>
        </header>

        <div class="main-content">
            <!-- Left Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3>Tools</h3>
                    <div class="tool-grid">
                        <div class="tool-btn draggable-tool" id="materialTool" data-tool="material" draggable="true">
                            <div class="tool-icon">‚ñ≤</div>
                            <span>Material</span>
                            <div class="drag-hint">Drag to canvas</div>
                        </div>
                        <div class="tool-btn draggable-tool" id="activityTool" data-tool="activity" draggable="true">
                            <div class="tool-icon">‚óè</div>
                            <span>Activity</span>
                            <div class="drag-hint">Drag to canvas</div>
                        </div>
                        <div class="tool-btn draggable-tool" id="textboxTool" data-tool="textbox" draggable="true">
                            <div class="tool-icon">üìù</div>
                            <span>Text Box</span>
                            <div class="drag-hint">Drag to canvas</div>
                        </div>
                        <button class="tool-btn" id="connectTool" data-tool="connect">
                            <div class="tool-icon">‚Üí</div>
                            <span>Connect</span>
                        </button>
                        <button class="tool-btn" id="deleteTool" data-tool="delete">
                            <div class="tool-icon">‚úï</div>
                            <span>Delete</span>
                        </button>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Natural Language Diagram</h3>
                    <textarea 
                        id="nlInput" 
                        placeholder="Describe your supply chain with varied patterns...
Examples:
‚Ä¢ Two plants manufacturing item A for three DCs
‚Ä¢ Show material flow from supplier to factories
‚Ä¢ Add transportation between multiple stores"
                        class="form-control nl-input"
                    ></textarea>
                    <button class="btn btn--primary btn--sm btn--full-width" id="generateBtn">Generate Diagram</button>
                </div>

                <div class="sidebar-section">
                    <h3>Connection Rules</h3>
                    <div class="rules-list">
                        <div class="rule-item valid">‚úì Material ‚Üí Activity</div>
                        <div class="rule-item valid">‚úì Activity ‚Üí Material</div>
                        <div class="rule-item invalid">‚úï Material ‚Üí Material</div>
                        <div class="rule-item invalid">‚úï Activity ‚Üí Activity</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Usage Guide</h3>
                    <div class="usage-list">
                        <div class="usage-item">üñ±Ô∏è Drag tools from sidebar to create elements</div>
                        <div class="usage-item">üìù Click element labels to edit names</div>
                        <div class="usage-item">üìã Click inside text boxes to edit content</div>
                        <div class="usage-item">üîó Click Connect tool, then drag between elements</div>
                        <div class="usage-item">üóëÔ∏è Click Delete tool, then click elements to remove</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Keyboard Shortcuts</h3>
                    <div class="shortcuts-list">
                        <div class="shortcut-item">
                            <kbd>Delete</kbd> / <kbd>Backspace</kbd>
                            <span>Delete selected</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl+Z</kbd>
                            <span>Undo action</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl+X</kbd>
                            <span>Cut selected</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Esc</kbd>
                            <span>Return to select</span>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>Examples</h3>
                    <button class="btn btn--outline btn--sm btn--full-width" id="loadExampleBtn">Load Sample Network</button>
                </div>

                <div class="sidebar-section debug-info">
                    <h3>Debug Info</h3>
                    <div class="debug-item">
                        <small>Mouse: <span id="mouseCoords">-</span></small>
                    </div>
                    <div class="debug-item">
                        <small>Canvas: <span id="canvasSize">800√ó600</span></small>
                    </div>
                    <div class="debug-item">
                        <small>Status: <span id="dragStatus">Ready</span></small>
                    </div>
                    <div class="debug-item">
                        <small>History: <span id="historyInfo">0 states</span></small>
                    </div>
                </div>
            </aside>

            <!-- Main Canvas Area -->
            <main class="canvas-container">
                <div class="canvas-wrapper">
                    <canvas id="canvas" width="800" height="600"></canvas>
                </div>
                <div class="status-bar">
                    <span id="statusText">Canvas ready. Default mode is select - drag elements to move. Drag tools from sidebar to create new elements.</span>
                </div>
            </main>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu hidden">
        <div class="context-menu-item single-node-item" id="addConnectedMaterial">Add Connected Material</div>
        <div class="context-menu-item single-node-item" id="addConnectedActivity">Add Connected Activity</div>
        <div class="context-menu-divider single-node-item"></div>
        <div class="context-menu-item single-node-item" id="editLabel">Edit Label</div>
        <div class="context-menu-item single-node-item" id="deleteNode">Delete Node</div>
        
        <div class="context-menu-item multi-node-item" id="duplicateSelection">Duplicate Selection</div>
        <div class="context-menu-item multi-node-item" id="deleteSelection">Delete Selection</div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal hidden">
        <div class="modal-content">
            <h3>Edit Content</h3>
            <textarea id="editInput" class="form-control edit-textarea" placeholder="Enter content"></textarea>
            <div class="modal-actions">
                <button class="btn btn--primary" id="saveEditBtn">Save</button>
                <button class="btn btn--outline" id="cancelEditBtn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Load File Input -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <script src="app.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supply Chain Canvas</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="header-title">Supply Chain Canvas</h1>
                <div class="header-actions">
                    <button id="undoBtn" class="btn btn--secondary btn--sm" disabled>
                        <span>Undo</span>
                    </button>
                    <button id="saveBtn" class="btn btn--secondary btn--sm">Save</button>
                    <button id="loadBtn" class="btn btn--secondary btn--sm">Load</button>
                    <button id="exportBtn" class="btn btn--secondary btn--sm">Export PNG</button>
                    <button id="clearBtn" class="btn btn--secondary btn--sm">Clear</button>
                    <button id="loadExampleBtn" class="btn btn--primary btn--sm">Load Example</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- Tools Section -->
                <div class="sidebar-section">
                    <h3>Tools</h3>
                    <div class="tool-grid">
                        <button id="panTool" class="tool-btn" title="Pan tool - drag to move canvas view">
                            <div class="tool-icon">üñêÔ∏è</div>
                            <span>Pan</span>
                        </button>
                        <button id="connectTool" class="tool-btn" title="Connect tool - click nodes to connect them">
                            <div class="tool-icon">üîó</div>
                            <span>Connect</span>
                        </button>
                        <button id="deleteTool" class="tool-btn" title="Delete tool - click to delete elements">
                            <div class="tool-icon">üóëÔ∏è</div>
                            <span>Delete</span>
                        </button>
                    </div>
                </div>

                <!-- Create Elements Section -->
                <div class="sidebar-section">
                    <h3>Create Elements</h3>
                    <div class="tool-grid">
                        <button id="materialTool" class="tool-btn draggable-tool" draggable="true" title="Material - drag to canvas to create">
                            <div class="tool-icon">üì¶</div>
                            <span>Material</span>
                            <div class="drag-hint">Drag to create</div>
                        </button>
                        <button id="activityTool" class="tool-btn draggable-tool" draggable="true" title="Activity - drag to canvas to create">
                            <div class="tool-icon">‚öôÔ∏è</div>
                            <span>Activity</span>
                            <div class="drag-hint">Drag to create</div>
                        </button>
                        <button id="textboxTool" class="tool-btn draggable-tool" draggable="true" title="Text Box - drag to canvas to create">
                            <div class="tool-icon">üìù</div>
                            <span>Text Box</span>
                            <div class="drag-hint">Drag to create</div>
                        </button>
                    </div>
                </div>

                <!-- Natural Language Generation -->
                <div class="sidebar-section">
                    <h3>Generate from Description</h3>
                    <textarea id="nlInput" class="form-control nl-input" placeholder="Describe your supply chain... e.g., 'Two raw materials consumed in a BOM to produce a finished good that is distributed to a DC'"></textarea>
                    <button id="generateBtn" class="btn btn--primary btn--full-width">Generate Diagram</button>
                </div>

                <!-- Connection Rules -->
                <div class="sidebar-section">
                    <h3>Connection Rules</h3>
                    <div class="rules-list">
                        <div class="rule-item valid">‚úÖ Material ‚Üí Activity</div>
                        <div class="rule-item valid">‚úÖ Activity ‚Üí Material</div>
                        <div class="rule-item valid">‚úÖ Any ‚Üí Text Box</div>
                        <div class="rule-item info">‚ÑπÔ∏è Textboxes can connect to anything</div>
                    </div>
                </div>

                <!-- Usage Instructions -->
                <div class="sidebar-section">
                    <h3>How to Use</h3>
                    <div class="usage-list">
                        <div class="usage-item">üñ±Ô∏è Drag elements from sidebar to canvas</div>
                        <div class="usage-item">‚úèÔ∏è Double-click elements to edit labels</div>
                        <div class="usage-item">üîó Use Connect tool to link elements</div>
                        <div class="usage-item">üìã Right-click for context menu</div>
                        <div class="usage-item">üéØ Drag to select multiple elements</div>
                    </div>
                </div>

                <!-- Keyboard Shortcuts -->
                <div class="sidebar-section">
                    <h3>Shortcuts</h3>
                    <div class="shortcuts-list">
                        <div class="shortcut-item">
                            <span>Undo</span>
                            <kbd>Ctrl+Z</kbd>
                        </div>
                        <div class="shortcut-item">
                            <span>Copy for Excel</span>
                            <kbd>Ctrl+C</kbd>
                        </div>
                        <div class="shortcut-item">
                            <span>Delete</span>
                            <kbd>Del</kbd>
                        </div>
                        <div class="shortcut-item">
                            <span>Pan Mode</span>
                            <kbd>Ctrl+Drag</kbd>
                        </div>
                        <div class="shortcut-item">
                            <span>Escape Selection</span>
                            <kbd>Esc</kbd>
                        </div>
                    </div>
                </div>

                <!-- Debug Information -->
                <div class="debug-info">
                    <h3>Debug Info</h3>
                    <div class="debug-item">
                        <small>Canvas Size:</small>
                        <span id="canvasSize">-</span>
                    </div>
                    <div class="debug-item">
                        <small>Mouse:</small>
                        <span id="mouseCoords">-</span>
                    </div>
                    <div class="debug-item">
                        <small>History:</small>
                        <span id="historyInfo">-</span>
                    </div>
                </div>
            </aside>

            <!-- Canvas Area -->
            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <canvas id="canvas" width="1200" height="800"></canvas>
                </div>

                <!-- Zoom Controls -->
                <div class="zoom-controls">
                    <button id="zoomOutBtn" class="btn btn--sm">-</button>
                    <span id="zoomLevel">100%</span>
                    <button id="zoomInBtn" class="btn btn--sm">+</button>
                    <button id="zoomResetBtn" class="btn btn--sm">Reset</button>
                </div>

                <!-- Status Bar -->
                <div class="status-bar">
                    <span id="statusText">Canvas ready. Default mode is select - drag elements to move. Drag tools from sidebar to create new elements.</span>
                    <span id="dragStatus" style="margin-left: 20px;">Ready</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu hidden">
        <!-- Single node items -->
        <div id="addConnectedMaterial" class="context-menu-item single-node-item">
            Add Connected Material
        </div>
        <div id="addConnectedActivity" class="context-menu-item single-node-item">
            Add Connected Activity
        </div>
        <div id="editLabel" class="context-menu-item single-node-item">
            Edit Label
        </div>
        <div class="context-menu-divider single-node-item"></div>
        <div id="deleteNode" class="context-menu-item single-node-item">
            Delete Node
        </div>
        
        <!-- Multi-selection items -->
        <div id="duplicateSelection" class="context-menu-item multi-node-item">
            Duplicate Selection
        </div>
        <div id="deleteSelection" class="context-menu-item multi-node-item">
            Delete Selection
        </div>
        
        <!-- Copy for Excel - available for both single and multi-selection -->
        <div class="context-menu-divider"></div>
        <div id="copyForExcel" class="context-menu-item">
            üìã Copy for Excel
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="modal hidden">
        <div class="modal-content">
            <h3>Edit Content</h3>
            <textarea id="editInput" class="form-control edit-textarea" placeholder="Enter content..."></textarea>
            <div class="modal-actions">
                <button id="cancelEditBtn" class="btn btn--secondary">Cancel</button>
                <button id="saveEditBtn" class="btn btn--primary">Save</button>
            </div>
        </div>
    </div>

    <!-- Hidden file input for loading -->
    <input type="file" id="fileInput" accept=".json" style="display: none;">

    <!-- JavaScript -->
    <script src="app.js"></script>
</body>
</html>
